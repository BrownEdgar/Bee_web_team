!function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s=26)}([function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s}));var a={EMAIL_EXIST:"This Email is already exists",SERVER_ERROR:"Something is Wrong, Server error",ID_ERROR:"ID is not found",ID_LENGTH_ERROR:"ID is not found, it is too short",NOTFOUND_ERROR:"Is not found",BENERR_FAILED:"Benefit update failed",NO_DATA_ERROR:"We don't have any data yet",CANDIDAT_NOTFOUND:"Candidat is not found",CANDIDAT_DELETED:"Candidat is alredy deleted!",UPDATE_ERROR:"Update failed",GIFT_ERROR:"This user has already received this benefit.",POSITION_EXIST:"This description or title already exists",VACATION_ERROR:"You cannot ask for vacation while on vacation",SUCCESSFUL:"Successful operation",EXTRA_ERROR:"Some field is superfluous / extra field",REGISTER_ERROR:"Some field is not present, please fill correct"},s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,s;return t=e,(n=[{key:"successful",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.SUCCESSFUL;e.status(201).json({message:t})}},{key:"idLengthError",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.ID_LENGTH_ERROR;e.status(409).json({message:t})}},{key:"notFoundError",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.NOTFOUND_ERROR;e.status(404).json({message:t})}},{key:"noDataError",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.NO_DATA_ERROR;e.status(500).json({message:t})}},{key:"conflictError",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Something is Wrong";e.status(409).json({message:t})}},{key:"candidatDelError",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.CANDIDAT_DELETED;e.status(409).json({message:t})}},{key:"registerError",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.REGISTER_ERROR;e.status(412).json({message:t})}},{key:"saveError",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.REGISTER_ERROR;e.status(412).json({message:t})}},{key:"serverError",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.SERVER_ERROR;e.status(500).json({message:t})}}])&&r(t.prototype,n),s&&r(t,s),e}()},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function s(e){var t="function"==typeof Map?new Map:void 0;return(s=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return i(e,arguments,u(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),o(r,e)})(e)}function i(e,t,n){return(i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var a=new(Function.bind.apply(e,r));return n&&o(a,n.prototype),a}).apply(null,arguments)}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return d}));var c=function(e){function t(e,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=a(this,u(t).call(this))).statusCode=e,r.message=n,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o(e,t)}(t,e),t}(s(Error)),d=function(e,t){var n=e.statusCode,r=e.message;t.status(n).json({status:"error",statusCode:n,message:r})}},function(e,t){e.exports=require("mongoose")},function(e,t){e.exports=require("express")},function(e,t,n){"use strict";n.r(t);var r=n(8),a=n.n(r),s=n(7),i=n.n(s),o=n(0);n(5);function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var c=new o.b,d=["firstname","lastname","salary","phoneNumber","email","password","repeatPassword","birthday","role"],l=["openPosId","name","surname","age","email","skills","experience","education","gender"],f=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"isRegister",value:function(e,t,n){if(9!=i.a.size(e.body))return c.registerError(t);if(!e.body.password)return c.registerError(t,"Please add password field");if(e.body.password.length<=6)return c.registerError(t,"Too few characters for password ".concat(e.body.password.length," it's must by 6+"));if(e.body.password!=e.body.repeatPassword)return c.registerError(t,"Passwords do not match");for(var r in e.body)if(!i.a.includes(d,r))return c.registerError(t,"".concat(r," field is not present, please fill correct"));n()}},{key:"isLogin",value:function(e,t,n){var r,s;return regeneratorRuntime.async((function(i){for(;;)switch(i.prev=i.next){case 0:if(i.prev=0,r=e.headers.authorization.split(" ")[1],s=a.a.verify(r,process.env.SESSION_SECRET)){i.next=7;break}return i.abrupt("return",t.status(401).json({message:"jwt token Error"}));case 7:e.userData=s;case 8:n(),i.next=14;break;case 11:return i.prev=11,i.t0=i.catch(0),i.abrupt("return",t.status(401).json({message:"Please Login before doing any operations",error:i.t0}));case 14:case"end":return i.stop()}}),null,null,[[0,11]])}},{key:"isIdCorrect",value:function(e,t,n){if(24!=e.params.userId.length)return c.idLengthError(t);n()}},{key:"checkCandidatAdds",value:function(e,t,n){for(var r in i.a.size(e.body),e.body)if(!i.a.includes(l,r))return c.registerError(t,"".concat(r," field is not present, please fill correct"));n()}}])&&u(t.prototype,n),r&&u(t,r),e}();t.default=f},function(e,t,n){"use strict";n.r(t);var r=n(2),a=n.n(r),s=a.a.Schema({_id:{type:a.a.Schema.Types.ObjectId},firstname:{type:String,required:!0,maxlength:100,minlength:2},lastname:{type:String,required:[!0,"surname fields is required"],maxlength:100,minlength:2},phoneNumber:{type:Number,required:[!0,"phoneNumber fields is required"]},email:{type:String,required:!0,maxlength:1024,minlength:5,unique:!0},salary:{type:Number,required:!0,default:null},password:{type:String,required:[!0,"password field is required"],maxlength:[156,"Too much characters"],minlength:[6,"Too few characters"]},birthday:{type:Date,required:[!0,"dob field is required"],min:"1957-09-28",max:"2000-01-01"},role:{type:String,enum:["0","1","2"],required:[!0,'Must by "0"-admin "1"-meneger, "2"-stuff']},deletedAt:{type:Date,default:null}},{timestamps:{createAt:"created_at"}});t.default=a.a.model("User",s)},function(e,t){e.exports=require("bcryptjs")},function(e,t){e.exports=require("lodash")},function(e,t){e.exports=require("jsonwebtoken")},function(e,t){e.exports=require("multer")},function(e,t){e.exports=require("http")},function(e,t){e.exports=require("cors")},function(e,t){e.exports=require("express-session")},function(e,t,n){var r=n(3).Router(),a=new(n(25));new(n(4));r.get("/",a.getTicketLists),r.post("/",a.addTicketList),r.get("/:ticketId",a.getTicketListById),r.patch("/:ticketId",a.updateTicketList),r.delete("/:ticketId",a.deleteTicketList),e.exports=r},function(e,t,n){"use strict";n.r(t);var r=n(2),a=n.n(r),s=a.a.Schema({_id:{type:a.a.Schema.Types.ObjectId},title:{type:String,validate:{validator:function(e){return/[a-zA-Z]/.test(e)},message:function(e){return"".concat(e.value," is not a valid phone number!")}},required:[!0,"User phone number required"]},description:{type:String,required:[!0,"field is required, please add a description"]}});t.default=a.a.model("Benefit",s)},function(e,t,n){"use strict";n.r(t);var r=n(2),a=n.n(r),s=a.a.Schema({benefitId:{type:"ObjectId",ref:"Benefit",required:[!0,"please fill in the field"]},userId:{type:"ObjectId",ref:"User",required:[!0,"please fill in the field"]}},{timestamps:{createdAt:"created_at"}});t.default=a.a.model("BenefitHistory",s)},function(e,t,n){"use strict";n.r(t);var r=n(2),a=n.n(r),s=a.a.Schema({_id:{type:a.a.Schema.Types.ObjectId},openPosId:{type:a.a.Schema.Types.ObjectId,ref:"OpenPosition",required:[!0,"openPosId is required, please indicate it"]},name:{type:String,required:[!0,"please indicate a field"],max:255,min:2},surname:{type:String,required:[!0,"please indicate a field"],max:255,min:2},email:{type:String,required:[!0,"please indicate a field"],max:255,min:6},gender:{type:String,enum:["male","female"],required:[!0,"please indicate your gender"]},age:{type:Number,required:[!0,"please indicate your age"],min:18,max:63},skills:{type:String,required:[!0,"please indicate yours skills"]},education:{type:String,required:[!0,"please indicate where you studied"]},experience:{type:String,required:[!0,"please indicate yours experience"]}});t.default=a.a.model("Condidat",s)},function(e,t,n){"use strict";n.r(t);var r=n(2),a=n.n(r),s=a.a.Schema({id:{type:a.a.Schema.Types.ObjectId},title:{type:String,required:!0,maxlength:100,minlength:2},description:{type:String,required:!0,maxlength:1024,minlength:2},gender:{type:String,enum:["male","female"]},ageLimit:{type:Number,default:18,min:18,max:63},salary:{type:Number,default:5e4,required:!0,min:5e4}});t.default=a.a.model("OpenPosition",s)},function(e,t,n){"use strict";n.r(t);var r=n(2),a=n.n(r),s=Date.now()+5184e6,i=a.a.Schema({userId:{type:a.a.Schema.Types.ObjectId,ref:"User",required:!0},dateStart:{type:Date,min:Date.now,max:s,default:function(){return Date.now()+108e5},required:!0},dateEnd:{type:Date,min:Date.now,max:s,default:function(){return Date.now()+6048e5},required:!0}});t.default=a.a.model("Ticket",i)},function(e,t,n){"use strict";n.r(t);n(1);var r=n(0),a=n(2),s=n.n(a);function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=new r.b,u=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.models=t}var t,n,a;return t=e,(n=[{key:"getBenefits",value:function(e){var t;return regeneratorRuntime.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,regeneratorRuntime.awrap(this.models.benefits.find().select("title description _id"));case 2:return(t=n.sent).length<1&&o.conflictError(e,r.a.NO_DATA_ERROR),n.abrupt("return",{count:t.length,benefits:t});case 5:case"end":return n.stop()}}),null,this)}},{key:"getBenefit",value:function(e,t){var n;return regeneratorRuntime.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,regeneratorRuntime.awrap(this.models.benefits.findOne({_id:t}).select("title description _id"));case 2:return(n=a.sent)||o.conflictError(e,r.a.ID_ERROR),a.abrupt("return",n);case 5:case"end":return a.stop()}}),null,this)}},{key:"addBenefits",value:function(e,t){var n,a,i=this,u=arguments;return regeneratorRuntime.async((function(c){for(;;)switch(c.prev=c.next){case 0:return n=u.length>2&&void 0!==u[2]?u[2]:"for a good job!",a=this.models.benefits.find({title:t,description:n}).exec().then((function(a){if(!(a.length>=1))return new i.models.benefits({_id:new s.a.Types.ObjectId,title:t,description:n}).save();o.conflictError(e,r.a.POSITION_EXIST)})),c.abrupt("return",a);case 3:case"end":return c.stop()}}),null,this)}},{key:"updateBenefits",value:function(e,t,n){var r;return regeneratorRuntime.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,regeneratorRuntime.awrap(this.models.benefits.findByIdAndUpdate({_id:t},{$set:n},{new:!0}).select("title description _id"));case 2:if(r=a.sent){a.next=5;break}return a.abrupt("return",o.notFoundError(e));case 5:return a.abrupt("return",r);case 6:case"end":return a.stop()}}),null,this)}},{key:"deleteBenefit",value:function(e){var t;return regeneratorRuntime.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,regeneratorRuntime.awrap(this.models.benefits.deleteOne({_id:e}));case 2:if(t=n.sent,console.log("benefits: ",t),0!=t.deletedCount){n.next=7;break}return n.abrupt("return",o.conflictError(409,r.a.ID_ERROR));case 7:return n.abrupt("return",{count:t.length,benefits:t});case 8:case"end":return n.stop()}}),null,this)}}])&&i(t.prototype,n),a&&i(t,a),e}();t.default=u},function(e,t,n){"use strict";n.r(t);var r=n(1),a=n(0);function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=new a.b,o=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.models=t}var t,n,o;return t=e,(n=[{key:"getBenefitsHistory",value:function(e){var t;return regeneratorRuntime.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,regeneratorRuntime.awrap(this.models.benefitsHistory.find().populate("benefitId","title").populate("userId","firstname"));case 2:if((t=n.sent).length){n.next=5;break}throw i.noDataError(e);case 5:return n.abrupt("return",{count:t.length,benHistory:t});case 6:case"end":return n.stop()}}),null,this)}},{key:"getHistoryById",value:function(e){var t;return regeneratorRuntime.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,regeneratorRuntime.awrap(this.models.benefitsHistory.findOne({_id:e}));case 2:if(t=n.sent){n.next=5;break}throw new r.a(409,a.a.ID_ERROR);case 5:return n.abrupt("return",t);case 6:case"end":return n.stop()}}),null,this)}},{key:"addBenefitsHistory",value:function(e,t,n){var s,o,u=this;return regeneratorRuntime.async((function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,regeneratorRuntime.awrap(this.models.benefits.find({_id:t}));case 2:if(s=c.sent,console.log("check: ",s),!(s.length<1)){c.next=6;break}throw i.notFoundError(e,"benefitId is not found");case 6:return o=this.models.benefitsHistory.find({benefitId:t,userId:n}).exec().then((function(r){if(!(r.length>=1)){var s=new u.models.benefitsHistory({benefitId:t,userId:n});return s.save(),s}i.notFoundError(e,a.a.GIFT_ERROR)})).catch((function(e){throw new r.a(500,a.a.GIFT_ERROR)})),c.abrupt("return",o);case 8:case"end":return c.stop()}}),null,this)}},{key:"deleteBenefitHistory",value:function(e){var t;return regeneratorRuntime.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,regeneratorRuntime.awrap(this.models.benefitsHistory.deleteOne({_id:e}));case 2:if(t=n.sent){n.next=5;break}throw new r.a(409,a.a.NOTFOUND_ERROR);case 5:return n.abrupt("return",{count:t.length,benHistory:t});case 6:case"end":return n.stop()}}),null,this)}}])&&s(t.prototype,n),o&&s(t,o),e}();t.default=o},function(e,t,n){"use strict";n.r(t);var r=n(6),a=n.n(r),s=n(2),i=n.n(s),o=n(1),u=n(0);function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var d=new u.b,l=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.models=t}var t,n,r;return t=e,(n=[{key:"getUser",value:function(e,t){var n;return regeneratorRuntime.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,regeneratorRuntime.awrap(this.models.users.findOne({_id:t,deletedAt:null}).select("firstname lastname email birthday phoneNumber role salary _id"));case 2:if(n=r.sent){r.next=5;break}return r.abrupt("return",d.conflictError(e,"User ".concat(u.a.ID_ERROR)));case 5:return r.abrupt("return",n);case 6:case"end":return r.stop()}}),null,this)}},{key:"getUsers",value:function(e){var t;return regeneratorRuntime.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,regeneratorRuntime.awrap(this.models.users.find({deletedAt:null}).select("firstname lastname salary phoneNumber email birthday password role _id"));case 2:if(!((t=n.sent).length<1)){n.next=5;break}throw new o.a(409,"".concat(u.a.NO_DATA_ERROR));case 5:return n.abrupt("return",{count:t.length,users:e.pagination});case 6:case"end":return n.stop()}}),null,this)}},{key:"addUser",value:function(e,t,n,r,s,o,c,l,f){var p,m=this;return regeneratorRuntime.async((function(v){for(;;)switch(v.prev=v.next){case 0:return p=this.models.users.find({email:o}).exec().then((function(p){if(console.log("user: ",p),p.length>=1)return d.conflictError(e,"".concat(u.a.EMAIL_EXIST));var v=new m.models.users({_id:new i.a.Types.ObjectId,firstname:t,lastname:n,salary:r,phoneNumber:s,email:o,password:c,birthday:l,role:f});a.a.genSalt(10,(function(t,n){a.a.hash(v.password,n,(function(t,n){if(t)throw t;return v.password=n,v.save((function(t){return t?d.saveError(e,"".concat(t.message)):d.successful(e)}))}))}))})).catch((function(t){return d.successful(e,"".concat(t.message))})),v.abrupt("return",p);case 2:case"end":return v.stop()}}),null,this)}},{key:"updateUser",value:function(e,t){var n;return regeneratorRuntime.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,regeneratorRuntime.awrap(this.models.users.findByIdAndUpdate({_id:e},{$set:t},{new:!0}).select("firsname lastname salary phoneNumber email birthday role"));case 2:if(n=r.sent,n){r.next=5;break}throw new o.a(409,"User ".concat(u.a.NOTFOUND_ERROR));case 5:return r.abrupt("return",n);case 6:case"end":return r.stop()}}),null,this)}},{key:"deleteUser",value:function(e,t){var n;return regeneratorRuntime.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,regeneratorRuntime.awrap(this.models.users.find({_id:t,deletedAt:{$gt:1}}));case 2:if(!(r.sent.length>=1)){r.next=7;break}throw d.notFoundError(e,"User is alredy Deleted");case 7:return r.next=9,regeneratorRuntime.awrap(this.models.users.findByIdAndUpdate({_id:t},{deletedAt:Date.now()}));case 9:if(n=r.sent){r.next=12;break}throw d.notFoundError(e,"User ".concat(u.a.NOTFOUND_ERROR));case 12:return r.abrupt("return",{count:n.length,user:n});case 13:case"end":return r.stop()}}),null,this)}}])&&c(t.prototype,n),r&&c(t,r),e}();t.default=l},function(e,t,n){"use strict";n.r(t);var r=n(2),a=n.n(r),s=n(1),i=n(0);function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var u=new i.b,c=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.models=t}var t,n,r;return t=e,(n=[{key:"getCandidats",value:function(e){var t;return regeneratorRuntime.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,regeneratorRuntime.awrap(this.models.candidat.find().select("openPosId name surname email age skills experience"));case 2:if(!((t=n.sent).length<1)){n.next=5;break}throw i.b.notFoundError(e,i.a.NO_DATA_ERROR);case 5:return n.abrupt("return",{count:t.length,candidats:t});case 6:case"end":return n.stop()}}),null,this)}},{key:"getSpecialCandidat",value:function(e){var t;return regeneratorRuntime.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,regeneratorRuntime.awrap(this.models.candidat.findOne({_id:e}).select("openPosId name surname email age skills experience"));case 2:if(t=n.sent){n.next=5;break}throw new s.a(409,i.a.NOTFOUND_ERROR);case 5:return n.abrupt("return",t);case 6:case"end":return n.stop()}}),null,this)}},{key:"addCandidats",value:function(e,t,n,r,s,o,c,d,l,f){var p,m=this;return regeneratorRuntime.async((function(v){for(;;)switch(v.prev=v.next){case 0:return p=this.models.candidat.find({email:s}).exec().then((function(p){if(p.length>=1)return u.conflictError(e,i.a.EMAIL_EXIST);new m.models.candidat({_id:new a.a.Types.ObjectId,openPosId:t,name:n,surname:r,email:s,age:o,gender:c,skills:d,education:l,experience:f}).save((function(t){return t?u.saveError(e,"".concat(t.message)):u.successful(e)}))})).catch((function(t){return console.log("sebastian",t),u.serverError(e)})),v.abrupt("return",p);case 2:case"end":return v.stop()}}),null,this)}},{key:"updateCandidat",value:function(e,t){var n,r=this;return regeneratorRuntime.async((function(a){for(;;)switch(a.prev=a.next){case 0:return console.log("updateOps",t.email),n=this.models.candidat.find({email:t.email}).exec().then((function(n){var a;return regeneratorRuntime.async((function(o){for(;;)switch(o.prev=o.next){case 0:if(!(n.length>=1)){o.next=4;break}return o.abrupt("return",new s.a(409,i.a.EMAIL_EXIST));case 4:return o.next=6,regeneratorRuntime.awrap(r.models.candidat.findByIdAndUpdate({_id:e},{$set:t},{new:!0}));case 6:if(a=o.sent){o.next=9;break}return o.abrupt("return",new s.a(400,i.a.UPDATE_ERROR));case 9:return o.abrupt("return",a);case 10:case"end":return o.stop()}}))})).catch((function(e){return new s.a(500,i.a.SERVER_ERROR)})),a.abrupt("return",n);case 3:case"end":return a.stop()}}),null,this)}},{key:"deleteCandidat",value:function(e){var t;return regeneratorRuntime.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,regeneratorRuntime.awrap(this.models.candidat.deleteOne({_id:e}));case 2:if(t=n.sent){n.next=5;break}throw new s.a(409,"Candidat ".concat(i.a.NOTFOUND_ERROR));case 5:return n.abrupt("return",{count:t.length,candidats:t});case 6:case"end":return n.stop()}}),null,this)}}])&&o(t.prototype,n),r&&o(t,r),e}();t.default=c},function(e,t,n){"use strict";n.r(t);var r=n(1),a=n(0);function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.models=t}var t,n,i;return t=e,(n=[{key:"getOpenPosition",value:function(){var e;return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,regeneratorRuntime.awrap(this.models.openPosition.find().select("_id title description ageLimit salary"));case 2:if(!((e=t.sent).length<1)){t.next=5;break}throw new r.a(500,a.a.NO_DATA_ERROR);case 5:return t.abrupt("return",{count:e.length,positions:e});case 6:case"end":return t.stop()}}),null,this)}},{key:"getSpecialPosition",value:function(e){var t;return regeneratorRuntime.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,regeneratorRuntime.awrap(this.models.openPosition.findOne({_id:e}).select("_id title description ageLimit salary"));case 2:if(t=n.sent){n.next=5;break}throw new r.a(500,"Position ".concat(a.a.ID_ERROR));case 5:return n.abrupt("return",t);case 6:case"end":return n.stop()}}),null,this)}},{key:"addOpenPosition",value:function(e,t,n,s,i){var o,u=this;return regeneratorRuntime.async((function(c){for(;;)switch(c.prev=c.next){case 0:return o=this.models.openPosition.find({$or:[{title:e},{description:t}]},{_id:0}).exec().then((function(o){if(o.length>=1)throw new r.a(500,"".concat(a.a.POSITION_EXIST));return new u.models.openPosition({title:e,description:t,gender:n,ageLimit:s,salary:i}).save(),{status:201,message:"Open Position is created"}})).catch((function(e){throw new r.a(500,"".concat(a.a.SERVER_ERROR))})),c.abrupt("return",o);case 2:case"end":return c.stop()}}),null,this)}},{key:"updateOpenPosition",value:function(e,t){var n;return regeneratorRuntime.async((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,regeneratorRuntime.awrap(this.models.openPosition.findByIdAndUpdate({_id:e},{$set:t},{new:!0}).select("_id title description ageLimit salary"));case 2:if(n=s.sent){s.next=5;break}throw new r.a(500,"Open Position ".concat(a.a.UPDATE_ERROR));case 5:return s.abrupt("return",n);case 6:case"end":return s.stop()}}),null,this)}},{key:"deleteOpenPosition",value:function(e){var t;return regeneratorRuntime.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,regeneratorRuntime.awrap(this.models.openPosition.deleteOne({_id:e}));case 2:if(t=n.sent){n.next=5;break}throw new r.a(500,"Open Position ".concat(a.a.NOTFOUND_ERROR));case 5:return n.abrupt("return",{count:t.length,position:t});case 6:case"end":return n.stop()}}),null,this)}}])&&s(t.prototype,n),i&&s(t,i),e}();t.default=i},function(e,t,n){"use strict";n.r(t);var r=n(1),a=n(0);function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.models=t}var t,n,i;return t=e,(n=[{key:"getTicketLists",value:function(){var e;return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,regeneratorRuntime.awrap(this.models.ticketList.find().sort({dateStart:1}));case 2:if(!((e=t.sent).length<1)){t.next=5;break}throw new r.a(409,a.a.NO_DATA_ERROR);case 5:return t.abrupt("return",{count:e.length,ticketList:e});case 6:case"end":return t.stop()}}),null,this)}},{key:"getTicketListById",value:function(e){var t;return regeneratorRuntime.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,regeneratorRuntime.awrap(this.models.ticketList.findOne({_id:e},{_id:0}).select("userId dateStart dateEnd"));case 2:if(t=n.sent){n.next=5;break}throw new r.a(409,"Ticket List ".concat(a.a.ID_ERROR));case 5:return n.abrupt("return",t);case 6:case"end":return n.stop()}}),null,this)}},{key:"addTicketList",value:function(e,t,n){var s,i=this;return regeneratorRuntime.async((function(o){for(;;)switch(o.prev=o.next){case 0:return s=this.models.ticketList.find({userId:e}).exec().then((function(s){return s.length>=1?new r.a(409,a.a.VACATION_ERROR):(new i.models.ticketList({userId:e,dateStart:t,dateEnd:n}).save(),{status:201,message:"Thanck you, Ticket List  is pending"})})).catch((function(e){return new r.a(500,a.a.SERVER_ERROR)})),o.abrupt("return",s);case 2:case"end":return o.stop()}}),null,this)}},{key:"updateTicketList",value:function(e,t){var n;return regeneratorRuntime.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,regeneratorRuntime.awrap(this.models.ticketList.findByIdAndUpdate({_id:e},{$set:t},{new:!0}).select("userId dateStart dateEnd"));case 2:if(n=a.sent,n){a.next=5;break}return a.abrupt("return",new r.a(409,"Ticket ListError ".concat(Message.UPDATE_ERROR)));case 5:return a.abrupt("return",new r.a(200,n));case 6:case"end":return a.stop()}}),null,this)}},{key:"deleteTicketList",value:function(e){var t;return regeneratorRuntime.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,regeneratorRuntime.awrap(this.models.ticketList.deleteOne({_id:e}));case 2:if(t=n.sent){n.next=5;break}return n.abrupt("return",new r.a(500,"Ticket List ".concat(a.a.NOTFOUND_ERROR)));case 5:return n.abrupt("return",{count:t.length,ticketList:t});case 6:case"end":return n.stop()}}),null,this)}}])&&s(t.prototype,n),i&&s(t,i),e}();t.default=i},function(e,t,n){"use strict";n.r(t);var r=n(1),a=n(0);function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,(n=[{key:"getTicketLists",value:function(e,t){var n;return regeneratorRuntime.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,regeneratorRuntime.awrap(e.app.services.ticketLists.getTicketLists());case 3:n=r.sent,t.status(201).send(n),r.next=10;break;case 7:r.prev=7,r.t0=r.catch(0),t.status(500).send(r.t0.message);case 10:case"end":return r.stop()}}),null,null,[[0,7]])}},{key:"getTicketListById",value:function(e,t){var n,r;return regeneratorRuntime.async((function(a){for(;;)switch(a.prev=a.next){case 0:return n=e.params.ticketId,a.prev=1,a.next=4,regeneratorRuntime.awrap(e.app.services.ticketLists.getTicketListById(n));case 4:r=a.sent,t.send(r),a.next=11;break;case 8:a.prev=8,a.t0=a.catch(1),t.send(a.t0.message);case 11:case"end":return a.stop()}}),null,null,[[1,8]])}},{key:"addTicketList",value:function(e,t){var n,r,a,s,i;return regeneratorRuntime.async((function(o){for(;;)switch(o.prev=o.next){case 0:return n=e.body,r=n.userId,a=n.dateStart,s=n.dateEnd,o.prev=1,o.next=4,regeneratorRuntime.awrap(e.app.services.ticketLists.addTicketList(r,a,s));case 4:i=o.sent,t.status(i.statusCode).send(i),o.next=11;break;case 8:o.prev=8,o.t0=o.catch(1),t.status(500).send(o.t0.message);case 11:case"end":return o.stop()}}),null,null,[[1,8]])}},{key:"updateTicketList",value:function(e,t){var n,r;return regeneratorRuntime.async((function(a){for(;;)switch(a.prev=a.next){case 0:return n=e.params.ticketId,r=e.body,a.next=4,regeneratorRuntime.awrap(e.app.services.ticketLists.updateTicketList(n,r).then((function(e){t.status(e.statusCode).send(e)})).catch((function(e){t.status(500).json({error:e})})));case 4:a.sent;case 5:case"end":return a.stop()}}))}},{key:"deleteTicketList",value:function(e,t){var n;return regeneratorRuntime.async((function(s){for(;;)switch(s.prev=s.next){case 0:return n=e.params.ticketId,s.prev=1,s.next=4,regeneratorRuntime.awrap(e.app.services.ticketLists.deleteTicketList(n));case 4:if(!s.sent.ticketList.deletedCount){s.next=8;break}return s.abrupt("return",t.status(201).json({message:"Ticket Lists is deleted!",benefitId:n}));case 8:throw new r.a(409,"Ticket List ".concat(a.a.ID_ERROR));case 11:s.prev=11,s.t0=s.catch(1),t.status(500).send(s.t0.message);case 14:case"end":return s.stop()}}),null,null,[[1,11]])}}])&&s(t.prototype,n),i&&s(t,i),e}();t.default=i},function(e,t,n){"use strict";n.r(t);var r=n(10),a=n.n(r),s=n(3),i=n.n(s),o=n(11),u=n.n(o),c=n(1),d=n(12),l=n.n(d),f=n(2),p=n.n(f),m={Benefit:n(14),BenefitsHistory:n(15),User:n(5),Candidats:n(16),OpenPosition:n(17),TicketList:n(18)},v={Benefit:n(19),BenefitsHistory:n(20),User:n(21),Candidat:n(22),OpenPosition:n(23),TicketList:n(24)},g=i.a.Router();g.get("/",(function(e,t){t.status(200).send("Heroku works")}));var y=g,h=n(6),b=n.n(h),R=n(5),w=n(8),x=n.n(w),k=n(0);function E(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var O=new k.b,I=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"getUsers",value:function(e,t){var n;return regeneratorRuntime.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,regeneratorRuntime.awrap(e.app.services.users.getUsers(t));case 3:n=r.sent,t.status(201).send(n),r.next=10;break;case 7:r.prev=7,r.t0=r.catch(0),t.status(500).send(r.t0.message);case 10:case"end":return r.stop()}}),null,null,[[0,7]])}},{key:"getMyInfo",value:function(e,t,n){var r;return regeneratorRuntime.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,regeneratorRuntime.awrap(e.app.services.users.getUser(t,e.userData.userId));case 3:return r=n.sent,n.abrupt("return",t.status(201).send(r));case 7:return n.prev=7,n.t0=n.catch(0),n.abrupt("return",O.notFoundError(t,"User ".concat(k.a.NOTFOUND_ERROR)));case 10:case"end":return n.stop()}}),null,null,[[0,7]])}},{key:"getUser",value:function(e,t){var n,r;return regeneratorRuntime.async((function(a){for(;;)switch(a.prev=a.next){case 0:return n=e.params.userId,a.prev=1,a.next=4,regeneratorRuntime.awrap(e.app.services.users.getUser(t,n));case 4:r=a.sent,t.status(201).send(r),a.next=11;break;case 8:a.prev=8,a.t0=a.catch(1),t.status(500).send(a.t0.message);case 11:case"end":return a.stop()}}),null,null,[[1,8]])}},{key:"addUser",value:function(e,t){var n,r,a,s,i,o,u,d,l;return regeneratorRuntime.async((function(f){for(;;)switch(f.prev=f.next){case 0:return n=e.body,r=n.firstname,a=n.lastname,s=n.salary,i=n.phoneNumber,o=n.email,u=n.password,d=n.birthday,l=n.role,f.next=3,regeneratorRuntime.awrap(e.app.services.users.addUser(t,r,a,s,i,o,u,d,l).then((function(e){console.log("result:",e),e?t.status(e.statusCode).json({message:e.message}):t.status(e.statusCode).json({message:e})})).catch((function(e){return new c.a(500,k.a.SERVER_ERROR)})));case 3:f.sent;case 4:case"end":return f.stop()}}))}},{key:"updateUser",value:function(e,t){var n,r;return regeneratorRuntime.async((function(a){for(;;)switch(a.prev=a.next){case 0:return n=e.params.userId,r=e.body,a.next=4,regeneratorRuntime.awrap(e.app.services.users.updateUser(n,r));case 4:a.sent.save().then((function(e){t.status(200).json(e)})).catch((function(e){throw new c.a(500,k.a.SERVER_ERROR)}));case 6:case"end":return a.stop()}}))}},{key:"deleteUser",value:function(e,t){var n;return regeneratorRuntime.async((function(r){for(;;)switch(r.prev=r.next){case 0:return n=e.params.userId,r.prev=1,r.next=4,regeneratorRuntime.awrap(e.app.services.users.deleteUser(t,n));case 4:return r.sent,r.abrupt("return",t.status(201).json({message:"User is deleted!",userId:n}));case 8:throw r.prev=8,r.t0=r.catch(1),new c.a(500,k.a.SERVER_ERROR);case 11:case"end":return r.stop()}}),null,null,[[1,8]])}}])&&E(t.prototype,n),r&&E(t,r),e}(),_=n(4),T=i.a.Router(),S=new I,P=new _.default;T.get("/",(function(e,t,n){t.send("register page")})),T.get("/login",(function(e,t,n){t.send("login page")})),T.post("/",P.isRegister,S.addUser),T.post("/login",(function(e,t,n){if(!e.body.email||!e.body.password)return t.status(401).json({message:"login failed",kind:"Invalid email or password"});R.default.findOne({email:e.body.email}).exec().then((function(n){if(n.length<1)return t.status(401).json({message:"login failed",kind:"Invalid email address"});b.a.compare(e.body.password,n.password,(function(e,r){if(e)return t.status(401).json({message:"login failed"});if(r){var a=x.a.sign({email:n.email,userId:n._id},process.env.SESSION_SECRET,{expiresIn:"1h"});return t.status(200).json({user:n,message:"Login successful",token:a})}t.status(401).json({message:"Login failed"})}))})).catch((function(e){console.log(e),t.status(500).json({error:e})}))}));var C=T;function j(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}new k.b;var D=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"getBenefit",value:function(e,t){var n,r;return regeneratorRuntime.async((function(a){for(;;)switch(a.prev=a.next){case 0:return n=e.params.id,a.prev=1,a.next=4,regeneratorRuntime.awrap(e.app.services.benefits.getBenefit(t,n));case 4:r=a.sent,t.status(200).send(r),a.next=11;break;case 8:a.prev=8,a.t0=a.catch(1),t.status(500).send(a.t0.message);case 11:case"end":return a.stop()}}),null,null,[[1,8]])}},{key:"getBenefits",value:function(e,t){var n;return regeneratorRuntime.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,regeneratorRuntime.awrap(e.app.services.benefits.getBenefits(t));case 3:n=r.sent,t.status(201).send(n),r.next=10;break;case 7:r.prev=7,r.t0=r.catch(0),t.status(500).send(r.t0.message);case 10:case"end":return r.stop()}}),null,null,[[0,7]])}},{key:"addBenefits",value:function(e,t){var n,r,a,s;return regeneratorRuntime.async((function(i){for(;;)switch(i.prev=i.next){case 0:return n=e.body,r=n.title,a=n.description,i.prev=1,i.next=4,regeneratorRuntime.awrap(e.app.services.benefits.addBenefits(t,r,a));case 4:s=i.sent,t.status(200).send(s),i.next=11;break;case 8:i.prev=8,i.t0=i.catch(1),t.status(500).send(i.t0.message);case 11:case"end":return i.stop()}}),null,null,[[1,8]])}},{key:"updateBenefits",value:function(e,t){var n,r;return regeneratorRuntime.async((function(a){for(;;)switch(a.prev=a.next){case 0:return n=e.params.id,r=e.body,a.next=4,regeneratorRuntime.awrap(e.app.services.benefits.updateBenefits(t,n,r).then((function(e){t.status(200).json(e)})).catch((function(e){t.status(500).json({error:e})})));case 4:a.sent;case 5:case"end":return a.stop()}}))}},{key:"deleteBenefits",value:function(e,t){var n;return regeneratorRuntime.async((function(r){for(;;)switch(r.prev=r.next){case 0:return n=e.params.id,r.prev=1,r.next=4,regeneratorRuntime.awrap(e.app.services.benefits.deleteBenefit(n));case 4:return r.sent,r.abrupt("return",t.status(201).json({message:"Benefit is deleted!",benefitId:n}));case 8:r.prev=8,r.t0=r.catch(1),t.status(500).send(r.t0.message);case 11:case"end":return r.stop()}}),null,null,[[1,8]])}}])&&j(t.prototype,n),r&&j(t,r),e}(),L=i.a.Router(),U=new D,B=new _.default;L.get("/",B.isLogin,U.getBenefits),L.post("/",U.addBenefits),L.get("/:id",U.getBenefit),L.patch("/:id",U.updateBenefits),L.delete("/:id",U.deleteBenefits);var N=L;function A(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var q=new k.b,H=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"getBenefitsHistory",value:function(e,t){var n;return regeneratorRuntime.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,regeneratorRuntime.awrap(e.app.services.benefitsHistorys.getBenefitsHistory(t));case 3:n=r.sent,t.status(201).send(n),r.next=10;break;case 7:r.prev=7,r.t0=r.catch(0),q.serverError(t,r.t0.message);case 10:case"end":return r.stop()}}),null,null,[[0,7]])}},{key:"getHistoryById",value:function(e,t){var n,r;return regeneratorRuntime.async((function(a){for(;;)switch(a.prev=a.next){case 0:return n=e.params.historyId,a.next=3,regeneratorRuntime.awrap(e.app.services.benefitsHistorys.getHistoryById(n).then((function(e){e&&t.status(200).send(e),t.status(r.statusCode).send(e)})).catch((function(e){t.status(e.statusCode).json({error:e})})));case 3:r=a.sent;case 4:case"end":return a.stop()}}))}},{key:"addBenefitsHistory",value:function(e,t){var n,r,a,s;return regeneratorRuntime.async((function(i){for(;;)switch(i.prev=i.next){case 0:return n=e.body,r=n.benefitId,a=n.userId,i.prev=1,i.next=4,regeneratorRuntime.awrap(e.app.services.benefitsHistorys.addBenefitsHistory(t,r,a));case 4:(s=i.sent)&&t.status(201).send(s),i.next=11;break;case 8:i.prev=8,i.t0=i.catch(1),q.serverError(t,i.t0);case 11:case"end":return i.stop()}}),null,null,[[1,8]])}},{key:"deleteBenefitHistory",value:function(e,t){var n,r;return regeneratorRuntime.async((function(a){for(;;)switch(a.prev=a.next){case 0:return n=e.params.historyId,a.prev=1,a.next=4,regeneratorRuntime.awrap(e.app.services.benefitsHistorys.deleteBenefitHistory(n));case 4:if(r=a.sent,console.log("delbenefits:",r),!r.benHistory.deletedCount){a.next=9;break}return a.abrupt("return",t.status(201).json({message:"Benefit History is deleted!",benefitId:n}));case 9:throw new c.a(409,k.a.ID_ERROR);case 12:throw a.prev=12,a.t0=a.catch(1),new c.a(500,k.a.SERVER_ERROR);case 15:case"end":return a.stop()}}),null,null,[[1,12]])}}])&&A(t.prototype,n),r&&A(t,r),e}(),F=i.a.Router(),M=new H;new _.default;F.get("/",M.getBenefitsHistory),F.post("/",M.addBenefitsHistory),F.get("/:historyId",M.getHistoryById),F.delete("/:historyId",M.deleteBenefitHistory);var V=F,G=new k.b;var X,$=i.a.Router(),z=new I,W=new _.default;$.get("/",[W.isLogin,(X=R.default,function(e,t,n){var r,a,s,i,o;return regeneratorRuntime.async((function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,regeneratorRuntime.awrap(X.find({deletedAt:null}));case 2:return u.sent.length<1&&G.noDataError(t),e.query.page||(e.query.page=1),e.query.limit||(e.query.limit=6),r=parseInt(e.query.page),a=parseInt(e.query.limit),s=(r-1)*a,i=r*a,o={},u.t0=i,u.next=14,regeneratorRuntime.awrap(X.countDocuments().exec());case 14:if(u.t1=u.sent,!(u.t0<u.t1)){u.next=17;break}o.next={page:r+1,limit:a};case 17:return s>0&&(o.previous={page:r-1,limit:a}),u.prev=18,u.next=21,regeneratorRuntime.awrap(X.find({deletedAt:null}).limit(a).skip(s).select("firstname lastname salary phoneNumber email birthday password role _id"));case 21:o.results=u.sent,t.pagination=o,n(),u.next=29;break;case 26:u.prev=26,u.t2=u.catch(18),G.serverError(t,u.t2.message);case 29:case"end":return u.stop()}}),null,null,[[18,26]])})],(function(e,t){t.json(t.pagination)})),$.get("/me",W.isLogin,z.getMyInfo),$.get("/:userId",[W.isIdCorrect],z.getUser),$.patch("/:userId",[W.isIdCorrect],z.updateUser),$.delete("/:userId",[W.isIdCorrect],z.deleteUser);var Y=$;function Z(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var J=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"getOpenPosition",value:function(e,t){var n;return regeneratorRuntime.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,regeneratorRuntime.awrap(e.app.services.openPositions.getOpenPosition());case 3:n=r.sent,t.status(201).send(n),r.next=10;break;case 7:r.prev=7,r.t0=r.catch(0),t.status(500).send(r.t0.message);case 10:case"end":return r.stop()}}),null,null,[[0,7]])}},{key:"getSpecialPosition",value:function(e,t){var n,r;return regeneratorRuntime.async((function(a){for(;;)switch(a.prev=a.next){case 0:return n=e.params.openPositionId,a.prev=1,a.next=4,regeneratorRuntime.awrap(e.app.services.openPositions.getSpecialPosition(n));case 4:r=a.sent,t.status(201).send(r),a.next=11;break;case 8:a.prev=8,a.t0=a.catch(1),t.status(500).send(a.t0.message);case 11:case"end":return a.stop()}}),null,null,[[1,8]])}},{key:"addOpenPosition",value:function(e,t){var n,r,a,s,i,o,u;return regeneratorRuntime.async((function(c){for(;;)switch(c.prev=c.next){case 0:return n=e.body,r=n.title,a=n.description,s=n.gender,i=n.ageLimit,o=n.salary,c.prev=1,c.next=4,regeneratorRuntime.awrap(e.app.services.openPositions.addOpenPosition(r,a,s,i,o));case 4:u=c.sent,t.status(u.status).send(u),c.next=11;break;case 8:c.prev=8,c.t0=c.catch(1),t.status(500).send(c.t0.message);case 11:case"end":return c.stop()}}),null,null,[[1,8]])}},{key:"updateOpenPosition",value:function(e,t){var n,r;return regeneratorRuntime.async((function(a){for(;;)switch(a.prev=a.next){case 0:return n=e.params.openPositionId,r=e.body,a.next=4,regeneratorRuntime.awrap(e.app.services.openPositions.updateOpenPosition(n,r));case 4:a.sent.save().then((function(e){t.status(200).json(e)})).catch((function(e){t.status(500).json({error:e})}));case 6:case"end":return a.stop()}}))}},{key:"deleteOpenPosition",value:function(e,t){var n;return regeneratorRuntime.async((function(r){for(;;)switch(r.prev=r.next){case 0:return n=e.params.openPositionId,r.prev=1,r.next=4,regeneratorRuntime.awrap(e.app.services.openPositions.deleteOpenPosition(n));case 4:if(!r.sent.position.deletedCount){r.next=8;break}return r.abrupt("return",t.status(201).json({message:"Open Position is deleted!",openPositionsId:n}));case 8:throw new c.a(400,"Open Position ".concat(k.a.ID_ERROR));case 11:r.prev=11,r.t0=r.catch(1),t.status(500).send(r.t0.message);case 14:case"end":return r.stop()}}),null,null,[[1,11]])}}])&&Z(t.prototype,n),r&&Z(t,r),e}(),K=i.a.Router(),Q=new J;new _.default;K.get("/",Q.getOpenPosition),K.post("/",Q.addOpenPosition),K.get("/:openPositionId",Q.getSpecialPosition),K.patch("/:openPositionId",Q.updateOpenPosition),K.delete("/:openPositionId",Q.deleteOpenPosition);var ee=K,te=n(9),ne=n.n(te),re=["application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/pdf","application/msword"];function ae(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var se=new k.b,ie=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"getCandidats",value:function(e,t){var n;return regeneratorRuntime.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,regeneratorRuntime.awrap(e.app.services.candidats.getCandidats(t));case 3:n=r.sent,t.status(201).send(n),r.next=10;break;case 7:r.prev=7,r.t0=r.catch(0),t.status(500).send(r.t0.message);case 10:case"end":return r.stop()}}),null,null,[[0,7]])}},{key:"getSpecialCandidat",value:function(e,t){var n,r;return regeneratorRuntime.async((function(a){for(;;)switch(a.prev=a.next){case 0:return n=e.params.candidatId,a.prev=1,a.next=4,regeneratorRuntime.awrap(e.app.services.candidats.getSpecialCandidat(n));case 4:r=a.sent,t.status(201).send(r),a.next=11;break;case 8:a.prev=8,a.t0=a.catch(1),t.status(500).send(a.t0.message);case 11:case"end":return a.stop()}}),null,null,[[1,8]])}},{key:"addCandidats",value:function(e,t){var n,r,a,s,i,o,u,c,d,l;return regeneratorRuntime.async((function(f){for(;;)switch(f.prev=f.next){case 0:return console.log("file:  ",e.file),n=e.body,r=n.openPosId,a=n.name,s=n.surname,i=n.email,o=n.age,u=n.gender,c=n.skills,d=n.education,l=n.experience,f.prev=2,f.next=5,regeneratorRuntime.awrap(e.app.services.candidats.addCandidats(t,r,a,s,i,o,u,c,d,l));case 5:f.next=10;break;case 7:f.prev=7,f.t0=f.catch(2),t.status(500).send(f.t0.message);case 10:case"end":return f.stop()}}),null,null,[[2,7]])}},{key:"updateCandidat",value:function(e,t){var n,r;return regeneratorRuntime.async((function(a){for(;;)switch(a.prev=a.next){case 0:return n=e.params.candidatId,r=e.body,a.next=4,regeneratorRuntime.awrap(e.app.services.candidats.updateCandidat(n,r).then((function(e){t.status(e.statusCode).send(e)})).catch((function(e){t.status(500).json({error:e})})));case 4:a.sent;case 5:case"end":return a.stop()}}))}},{key:"deleteCandidat",value:function(e,t){var n;return regeneratorRuntime.async((function(r){for(;;)switch(r.prev=r.next){case 0:return n=e.params.candidatId,r.prev=1,r.next=4,regeneratorRuntime.awrap(e.app.services.candidats.deleteCandidat(n));case 4:if(!r.sent.candidats.deletedCount){r.next=10;break}return r.abrupt("return",se.successful(t,"Candidat is deleted"));case 10:return r.abrupt("return",se.candidatDelError(t,"Candidat ".concat(k.a.ID_ERROR," | ").concat(k.a.CANDIDAT_DELETED)));case 11:r.next=16;break;case 13:r.prev=13,r.t0=r.catch(1),t.status(500).send(r.t0.message);case 16:case"end":return r.stop()}}),null,null,[[1,13]])}}])&&ae(t.prototype,n),r&&ae(t,r),e}(),oe=i.a.Router(),ue=ne.a.diskStorage({destination:function(e,t,n){n(null,"./uploads/")},filename:function(e,t,n){n(null,(new Date).toISOString().replace(/:/g,"-")+t.originalname)}}),ce=ne()({storage:ue,limits:{fileSize:10485760},fileFilter:function(e,t,n){t.mimetype===re[0]||t.mimetype===re[1]||t.mimetype===re[2]?n(null,!0):n(new Error("cv Error: file type must by 'png', 'docx' or 'doc'."),!1)}}),de=new ie,le=new _.default;oe.get("/",de.getCandidats),oe.post("/",[le.checkCandidatAdds,ce.single("cv")],de.addCandidats),oe.get("/:candidatId",le.isIdCorrect,de.getSpecialCandidat),oe.patch("/:candidatId",le.isIdCorrect,de.updateCandidat),oe.delete("/:candidatId",le.isIdCorrect,de.deleteCandidat);var fe=oe,pe=n(13),me=n.n(pe);var ve=i()();ve.use(i.a.json()),ve.use(i.a.urlencoded({extended:!1})),p.a.connect(process.env.DB_CONNECTION,{useUnifiedTopology:!0,useNewUrlParser:!0,useCreateIndex:!0},(function(e){return console.log(e)}));ve.use(u()({origin:!0,optionsSuccessStatus:200})),ve.use(i.a.urlencoded({extended:!1})),ve.use(i.a.json()),ve.use(l()({secret:process.env.SESSION_SECRET,resave:!1,saveUninitialized:!0})),ve.use("/",y),ve.use("/signup",C),ve.use("/benefits",N),ve.use("/benefits-history",V),ve.use("/users",Y),ve.use("/open-positions",ee),ve.use("/candidats",fe),ve.use("/ticket-lists",me.a),ve.models={users:m.User,benefits:m.Benefit,openPosition:m.OpenPosition,candidat:m.Candidats,benefitsHistory:m.BenefitsHistory,ticketList:m.TicketList},ve.services={users:new v.User(ve.models),benefits:new v.Benefit(ve.models),openPositions:new v.OpenPosition(ve.models),candidats:new v.Candidat(ve.models),benefitsHistorys:new v.BenefitsHistory(ve.models),ticketLists:new v.TicketList(ve.models)},ve.use((function(e,t,n){e.app=ve,n()})),ve.use((function(e,t,n){throw new c.a(404,"page is not found")})),ve.use((function(e,t,n,r){n.status(e.status||500),n.json({error:{message:e.message}})})),ve.use((function(e,t,n,r){Object(c.b)(e,n)}));var ge=ve,ye=process.env.PORT||3e3;a.a.createServer(ge).listen(ye,(function(){return console.log("server started on ".concat(ye))}))}]);